generator client {
    provider = "prisma-client-js"
    previewFeatures = ["referentialIntegrity"]
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
    referentialIntegrity = "prisma"
}
model User {
    id          String          @id @default(cuid())
    ci          String          @unique
    name        String          @default("")
    password    String?
    phoneNumber String?
    updatedBy   String
    plans       UserPlan[]
}

model Plan {
    id         String      @id @default(cuid())
    accessType String      @default("Ilimitado")
    name       String      @unique
    price      Int
    updatedBy  String
    users      UserPlan[]
}

model UserPlan {
    id            String          @id @default(cuid())
    accessHistory AccessHistory[]
    endingDate    DateTime
    plan          Plan            @relation(fields: [planId],references: [id], onDelete:Cascade, onUpdate: Cascade)
    planId        String
    startingDate  DateTime
    updatedBy     String
    user          User            @relation(fields: [userId], references: [id], onDelete:Cascade, onUpdate: Cascade)
    userId        String       
}

model AccessHistory {
    id         String   @id @default(cuid())
    date       DateTime
    userPlan   UserPlan @relation(fields: [userPlanId], references: [id], onDelete:Cascade, onUpdate: Cascade )
    userPlanId String
}